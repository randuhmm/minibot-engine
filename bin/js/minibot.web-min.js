/**
 * almond 0.2.0 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

(function(e,t){typeof define=="function"&&define.amd?define(t):e.minibot=t()})(this,function(){var e,t,n;return function(r){function p(e,t){var n,r,i,s,o,u,a,f,c,h,p=t&&t.split("/"),d=l.map,v=d&&d["*"]||{};if(e&&e.charAt(0)==="."&&t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(f=0;f<e.length;f+=1){h=e[f];if(h===".")e.splice(f,1),f-=1;else if(h===".."){if(f===1&&(e[2]===".."||e[0]===".."))break;f>0&&(e.splice(f-1,2),f-=2)}}e=e.join("/")}if((p||v)&&d){n=e.split("/");for(f=n.length;f>0;f-=1){r=n.slice(0,f).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=f;break}}}if(s)break;!u&&v&&v[r]&&(u=v[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function d(e,t){return function(){return s.apply(r,h.call(arguments,0).concat([e,t]))}}function v(e){return function(t){return p(t,e)}}function m(e){return function(t){a[e]=t}}function g(e){if(f.hasOwnProperty(e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!a.hasOwnProperty(e)&&!c.hasOwnProperty(e))throw new Error("No "+e);return a[e]}function y(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function b(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=[].slice;o=function(e,t){var n,r=y(e),i=r[0];return e=r[1],i&&(i=p(i,t),n=g(i)),i?n&&n.normalize?e=n.normalize(e,v(t)):e=p(e,t):(e=p(e,t),r=y(e),i=r[0],e=r[1],i&&(n=g(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return d(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:b(e)}}},i=function(e,t,n,i){var s,l,h,p,v,y=[],b;i=i||e;if(typeof n=="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(v=0;v<t.length;v+=1){p=o(t[v],i),l=p.f;if(l==="require")y[v]=u.require(e);else if(l==="exports")y[v]=u.exports(e),b=!0;else if(l==="module")s=y[v]=u.module(e);else if(a.hasOwnProperty(l)||f.hasOwnProperty(l)||c.hasOwnProperty(l))y[v]=g(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,d(i,!0),m(l),{}),y[v]=a[l]}}h=n.apply(a[e],y);if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!b)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){return typeof e=="string"?u[e]?u[e](t):g(o(e,t).f):(e.splice||(l=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},15),s)},s.config=function(e){return l=e,s},n=function(e,t,n){t.splice||(n=t,t=[]),f[e]=[e,t,n]},n.amd={jQuery:!0}}(),n("../lib/almond",function(){}),n("minibot/event/EventDispatcher",[],function(){var e=Class.create({listeners:null,initialize:function(){this.listeners={}},addEventListener:function(e,t){var n;this.listeners[e]==undefined?(n=new Array,this.listeners[e]=n):n=this.listeners[e],n.push(t)},hasEventListener:function(e){return this.listeners[e]!=undefined},dispatchEvent:function(e){var t;if(this.listeners[e.type]==undefined)return!1;t=this.listeners[e.type],e.target=this;for(var n=0;n<t.length;n++){var r=t[n];r(e)}return!0},removeEventListener:function(e,t){var n;if(this.listeners[e]==undefined)return;n=this.listeners[e];var r=n.indexOf(t);if(r==-1)return;n.splice(r,1),n.length==0&&delete this.listeners[e]},removeAllEventListeners:function(){this.listeners={}}});return e}),n("minibot/display/DisplayObject",["minibot/event/EventDispatcher"],function(e){var t=Class.create(e,{parent:null,initialize:function($super){$super()},onAddedToParent:function(){}});return Object.extend(t,{AddResource:function(e,t,n){e.RESOURCES==undefined&&(e.RESOURCES={}),e.RESOURCES[t]==undefined&&(e.RESOURCES[t]={}),e.RESOURCES[t][n]=null},AddObject:function(e,t){e.OBJECTS==undefined&&(e.OBJECTS=[]),e.OBJECTS.push(t)},GetResource:function(e,t,n){return e.RESOURCES==undefined?null:e.RESOURCES[t]==undefined?null:e.RESOURCES[t][n]==undefined?null:e.RESOURCES[t][n]}}),t.ALIGN_HORZ_CENTER=1,t.ALIGN_VERT_CENTER=2,t}),n("minibot/display/scene/SceneDisplayObject",["minibot/display/DisplayObject"],function(e){var t=Class.create(e,{x:0,y:0,w:0,h:0,root:null,scene:null,isVisible:!0,initialize:function($super){$super()},render:function(e,t,n){},onAddedToScene:function(){},onRemovedFromScene:function(){},getScene:function(){return this.scene},getWidth:function(){return this.w},getHeight:function(){return this.h},getSceneX:function(){var e=0;return this.parent!=null&&(e+=this.parent.getSceneX()),e+=this.x,e},getSceneY:function(){var e=0;return this.parent!=null&&(e+=this.parent.getSceneY()),e+=this.y,e},setRoot:function(e){this.root=e},setScene:function(e){this.scene=e},setWidth:function(e){this.w=e},setHeight:function(e){this.h=e},hide:function(){this.isVisible=!1},show:function(){this.isVisible=!0},setAlign:function(t,n,r){n instanceof Array||(n=[n]),r==undefined&&(r=!1);var i,s,o;switch(t){case e.ALIGN_HORZ_CENTER:var s=this.getSceneX()+this.getWidth()/2;for(var u=0;u<n.length;u++)i=n[u],o=i.getSceneX()+i.getWidth()/2,i.x+=s-o;break;case e.ALIGN_VERT_CENTER:var s=this.getSceneY()+this.getHeight()/2;for(var u=0;u<n.length;u++)i=n[u],o=i.getSceneY()+i.getHeight()/2,i.y+=s-o}}});return t}),n("minibot/display/scene/Container",["./SceneDisplayObject"],function(e){var t=Class.create(e,{layers:null,touchChildren:!0,resizable:!0,scalable:!0,scale:1,initialize:function($super){$super(),this.layers=new Array},addChild:function(e,t,n){t==undefined&&(t=0);while(this.layers.length<=t)this.layers.push(new Array);n==undefined&&(n=this.layers[t].length),this.layers[t].splice(n,0,e),this.scalable&&this.scale!=1&&(e.w*=this.scale,e.h*=this.scale,e.x*=this.scale,e.y*=this.scale),this.root!=null&&(e.root=this.root,e.scene=this.scene,e.parent=this,e.onAddedToScene()),this.resizable&&(this.w<e.x+e.w&&(this.w=e.x+e.w),this.h<e.y+e.h&&(this.h=e.y+e.h))},removeChild:function(e){for(var t=0;t<this.layers.length;t++){var n=this.layers[t];for(var r=0;r<n.length;r++)if(e===n[r]){n.splice(r,1),e.onRemovedFromScene();return}}},removeAll:function(){var e=this.layers,t;for(var n=0;n<e.length;n++){var r=e[n];for(var i=0;i<r.length;i++)t=r[i],t.onRemovedFromScene()}this.layers=new Array},render:function(e,t,n){if(this.scene==null)return;t==undefined&&(t=0),n==undefined&&(n=0);var r,i,s,o,u,a;for(r=0;r<this.layers.length;r++){s=this.layers[r];for(i=0;i<s.length;i++){o=s[i];if(!o.isVisible)continue;u=this.x+t+o.x,a=this.y+n+o.y;if(u>=this.root.w||u<-1*o.w||a>=this.root.h||a<-1*o.h)continue;o.render(e,this.x+t,this.y+n)}}},setChildIndex:function(e,t){for(var n=0;n<this.layers.length;n++){var r=this.layers[n];for(var i=0;i<r.length;i++)if(e===r[i]){if(t>=r.length)return;r.splice(i,1),r.splice(t,0,e);return}}},dispatchEvent:function($super,e){var t=!1,n=!1,r,i,s,o;if("x"in e&&"y"in e){e.x-=this.x,e.y-=this.y;for(r=this.layers.length-1;r>=0;r--){s=this.layers[r];for(i=s.length-1;i>=0;i--){o=s[i];if(!o.isVisible)continue;e.x>=o.x&&e.x<=o.x+o.w&&e.y>=o.y&&e.y<=o.y+o.h&&(n=o.dispatchEvent(e),t=!0);if(t)break}if(t)break}}return n?!0:("x"in e&&"y"in e&&(e.x+=this.x,e.y+=this.y),$super(e))},onAddedToScene:function($super){$super();var e,t,n,r;for(e=0;e<this.layers.length;e++){n=this.layers[e];for(t=0;t<n.length;t++)r=n[t],r.root=this.root,r.scene=this.scene,r.parent=this,r.onAddedToScene()}},onRemovedFromScene:function($super){$super();for(var e=0;e<this.layers.length;e++){var t=this.layers[e];for(var n=0;n<t.length;n++)t[n].onRemovedFromScene();this.layers[e]=null}this.layers=new Array},setScale:function(e){if(!this.scalable)return;var t=e/this.scale;for(l=0;l<this.layers.length;l++){layer=this.layers[l];for(d=0;d<layer.length;d++)displayObject=layer[d],displayObject.w*=t,displayObject.h*=t,displayObject.x*=t,displayObject.y*=t}this.w*=t,this.h*=t,this.scale=e}});return t}),n("minibot/display/scene/Scene",["minibot/event/EventDispatcher","./Container"],function(e,t){var n=Class.create({container:null,width:null,height:null,options:null,initialize:function(e){this.options=e,this.container=new t,this.container.resizable=!1,this.container.setRoot(this.container),this.container.setScene(this)},hasOption:function(e){return this.options[e]!=undefined},getOption:function(e){return this.options[e]},getBuffer:function(){},setWidth:function(e){this.width=e,this.container.setWidth(e)},getWidth:function(){return this.width},setHeight:function(e){this.height=e,this.container.setHeight(e)},getHeight:function(){return this.height},addChild:function(e,t){if(t==undefined||t==null)t=0;this.container.addChild(e,t)},removeChild:function(e){this.container.removeChild(e)},removeAllChildren:function(){this.container.removeAll()},render:function(e){this.container.render(e)},clear:function(){},drawBuffer:function(){},drawImage:function(e,t,n,r,i,s,o,u,a){},drawLine:function(e,t,n,r){},drawRect:function(e,t,n,r,i){},setFillColor:function(e){},setFillPattern:function(e){},setLineColor:function(e){},setLineStyle:function(e){},setLineWidth:function(e){},save:function(){},restore:function(){},translate:function(e,t){},rotate:function(e){},addEventListener:function(e,t){this.container.addEventListener(e,t)},hasEventListener:function(e){return this.container.addEventListener(e)},dispatchEvent:function(e){return this.container.dispatchEvent(e)},removeEventListener:function(e,t){this.container.removeEventListener(e,t)},removeAllEventListeners:function(){this.container.removeAllEventListeners()}});return n.MOUSE_EVENTS=1,n.KEYBOARD_EVENTS=2,n.TOUCH_EVENTS=4,n}),n("minibot/event/BaseEvent",[],function(){var e=Class.create({type:null,target:null,currentTarget:null,bubbles:null,cancelable:null,currentPhase:null,initialize:function(e,t,n){this.type=e,this.bubbles=t==undefined?!1:t,this.cancelable=n==undefined?!1:n},preventDefault:function(){}});return e}),n("minibot/event/MouseEvent",["./BaseEvent"],function(e){var t=Class.create(e,{x:null,y:null,displayObject:null,initialize:function($super,e,t,n,r,i,s){$super(e,t,n),this.x=r,this.y=i,this.displayObject=s}});return t.CLICK="mouseClick",t.MOUSE_DOWN="mouseDown",t.MOUSE_UP="mouseUp",t.MOUSE_MOVE="mouseMove",t}),n("minibot/event/TouchEvent",["./BaseEvent"],function(e){var t=Class.create(e,{x:null,y:null,displayObject:null,initialize:function($super,e,t,n,r,i,s){$super(e,t,n),this.x=r,this.y=i,this.displayObject=s}});return t.TOUCH_START="touchStart",t.TOUCH_END="touchEnd",t.TOUCH_MOVE="touchMove",t}),n("minibot/event/KeyboardEvent",["./BaseEvent"],function(e){var t=Class.create(e,{key:null,initialize:function($super,e,t,n,r){$super(e,t,n),this.key=r}});return t.KEY_DOWN="keyDown",t.KEY_UP="keyUp",t}),n("minibot/event/enum/Keyboard",[],function(){var e={KEY_A:"A",KEY_B:"B",KEY_C:"C",KEY_D:"D",KEY_E:"E",KEY_F:"F",KEY_G:"G",KEY_H:"H",KEY_I:"I",KEY_J:"J",KEY_K:"K",KEY_L:"L",KEY_M:"M",KEY_N:"N",KEY_O:"O",KEY_P:"P",KEY_Q:"Q",KEY_R:"R",KEY_S:"S",KEY_T:"T",KEY_U:"U",KEY_V:"V",KEY_W:"W",KEY_X:"X",KEY_Y:"Y",KEY_Z:"Z",KEY_0:0,KEY_1:1,KEY_2:2,KEY_3:3,KEY_4:4,KEY_5:5,KEY_6:6,KEY_7:7,KEY_8:8,KEY_9:9,KEY_UP:10,KEY_RIGHT:11,KEY_DOWN:12,KEY_LEFT:13,KEY_SPACE:" "};return e}),n("minibot/graphics/Color",[],function(){var e=Class.create({r:null,g:null,b:null,h:null,s:null,l:null,a:null,mode:null,initialize:function(t,n,r,i,s){this.type=e.TYPE,this.setColor(t,n,r,i,s)},setColor:function(t,n,r,i,s){this.mode=t,this.a=s!=undefined?s:1;if(t==e.RGB)this.r=n,this.g=r,this.b=i;else{if(t!=e.HSL)throw new Error("Color: unrecognized color mode.");this.h=n,this.s=r,this.l=i;var o=e.HslToRgb(this.h,this.s,this.l);this.r=Math.round(o[0]),this.g=Math.round(o[1]),this.b=Math.round(o[2])}},getAsArray:function(t){if(t==e.RGB)return[this.r,this.g,this.b,this.a];if(t==e.HSL)return[this.h,this.s,this.l,this.a];throw new Error("Color: unrecognized color mode.")},getAsString:function(e,t){return t=t==undefined?",":t,this.getAsArray(e).join(t)}});return e.RgbToHsl=function(e,t,n){},e.HslToRgb=function(e,t,n){if(t<=0)return[n,n,n];e=e/256*6,t/=255,n/=255;var r=(1-Math.abs(2*n-1))*t,i=(1-Math.abs(e%2-1))*r,s=n-.5*r,o=0,u=0,a=0;return e<1?(o=r,u=i,a=0):e<2?(o=i,u=r,a=0):e<3?(o=0,u=r,a=i):e<4?(o=0,u=i,a=r):e<5?(o=i,u=0,a=r):(o=r,u=0,a=i),[(o+s)*255,(u+s)*255,(a+s)*255]},e.FromHex=function(t){var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return n?new e(e.RGB,parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)):null},e.RGB="rgb",e.HSL="hsl",e.TYPE="color",e}),n("minibot/display/scene/Buffer",["./Container"],function(e){var t=Class.create(e,{bufferScene:null,initialize:function($super,e){$super(),this.bufferScene=e,this.resizable=!1},renderBuffer:function(t,n){var r=this.scene,i=this.root;this.root=this,this.scene=this.bufferScene,this.onAddedToScene(),e.prototype.render.call(this,0,t,n),this.root=i,this.scene=r},render:function(){}});return t}),n("minibot/display/html/CanvasBuffer",["minibot/display/scene/Buffer"],function(e){var t=Class.create(e,{initialize:function($super,e){$super(e)},setWidth:function($super,e){$super(e),this.bufferScene.setWidth(e)},setHeight:function($super,e){$super(e),this.bufferScene.setHeight(e)},render:function(e,t,n){var r=this.bufferScene.getElement();this.scene.drawImage(r,t*-1,n*-1,this.scene.width,this.scene.height,0,0,this.scene.width,this.scene.height)}});return t}),n("minibot/display/html/CanvasScene",["minibot/display/scene/Scene","minibot/event/MouseEvent","minibot/event/TouchEvent","minibot/event/KeyboardEvent","minibot/event/enum/Keyboard","minibot/graphics/Color","minibot/display/html/CanvasBuffer"],function(e,t,n,r,i,s,o){var u=Class.create(e,{element:null,context:null,ratio:null,enableEvents:null,eventTypes:null,mouseBfx:null,keyboardBfx:null,touchBfx:null,maxTouches:null,touchMap:null,touchCount:null,initialize:function($super,t){t==undefined&&(t={}),$super(t),this.element=this.hasOption("element")?this.getOption("element"):new Element("canvas"),this.enableEvents=this.hasOption("enableEvents")?this.getOption("enableEvents"):!0,this.eventTypes=this.hasOption("eventTypes")?this.getOption("eventTypes"):e.MOUSE_EVENTS,this.maxTouches=this.hasOption("maxTouches")?this.getOption("maxTouches"):1,this.setWidth(this.hasOption("width")?this.getOption("width"):this.element.width),this.setHeight(this.hasOption("height")?this.getOption("height"):this.element.height),this.ratio=1,this.hasOption("ratio")&&(this.ratio=this.getOption("ratio"),this.ratio!=1&&(this.element.style.width=this.element.width/this.ratio+"px",this.element.style.height=this.element.height/this.ratio+"px")),this.context=this.element.getContext("2d"),this.touchMap={},this.touchCount=0,this.enableEvents&&(this.eventTypes&e.MOUSE_EVENTS&&(this.mouseBfx=this.handleMouseEvent.bind(this),this.element.observe("mousedown",this.mouseBfx),this.element.observe("mouseup",this.mouseBfx),this.element.observe("mousemove",this.mouseBfx)),this.eventTypes&e.TOUCH_EVENTS&&(this.touchBfx=this.handleTouchEvent.bind(this),this.element.observe("touchstart",this.touchBfx),this.element.observe("touchend",this.touchBfx),this.element.observe("touchmove",this.touchBfx)),this.eventTypes&e.KEYBOARD_EVENTS&&(this.keyboardBfx=this.handleKeyboardEvent.bind(this),document.observe("keydown",this.keyboardBfx),document.observe("keyup",this.keyboardBfx)))},setWidth:function($super,e){$super(e),this.element.width=e},setHeight:function($super,e){$super(e),this.element.height=e},getElement:function(){return this.element},clear:function(){this.setWidth(this.width)},drawImage:function(e,t,n,r,i,s,o,u,a){this.context.drawImage(e,t,n,r,i,s,o,u,a)},drawLine:function(e,t,n,r){this.context.beginPath(),this.context.moveTo(e,t),this.context.lineTo(n,r),this.context.stroke()},drawPoly:function(e,t,n){},drawRect:function(e,t,n,r,i){this.context.fillRect(t,n,r,i)},drawText:function(e,t,n,r,i){if(n!=null){this.context.font=n.getWeight()+" "+n.getSize()+"pt "+n.getFamily();var s=n.getColor();s&&this.setFillColor(s);var o=n.getAlign();o&&(this.context.textAlign=o)}this.context.fillText(t,r,i)},createBuffer:function(){var e=new u,t=new o(e);return t},drawBuffer:function(e){},setFillColor:function(e){this.context.fillStyle="rgba("+e.getAsString(s.RGB)+")"},setFillPattern:function(e){if(!e.hasPattern()){var t=e.sprite,n=new u;n.setWidth(t.w),n.setHeight(t.h),n.drawImage(t.sprite.img,t.sprite.x,t.sprite.y,t.sprite.w,t.sprite.h,t.x,t.y,t.w,t.h),e.setPattern(this.context.createPattern(n.getElement(),e.repeat))}this.context.fillStyle=e.getPattern()},setLineColor:function(e){},setLineStyle:function(e){},setLineWidth:function(e){},save:function(){this.context.save()},restore:function(){this.context.restore()},translate:function(e,t){this.context.translate(e,t)},rotate:function(e){this.context.rotate(e)},handleMouseEvent:function(e){e.preventDefault();var n=e.currentTarget.offsetLeft*-1+e.currentTarget.offsetParent.offsetLeft*-1,r=e.currentTarget.offsetTop*-1+e.currentTarget.offsetParent.offsetTop*-1,i;n=(n+e.clientX)*this.ratio,r=(r+e.clientY)*this.ratio;switch(e.type){case"mousedown":i=t.MOUSE_DOWN;break;case"mousemove":i=t.MOUSE_MOVE;break;case"mouseup":i=t.MOUSE_UP;break;default:return}var s=new t(i,!1,!1,n,r,this.container);this.dispatchEvent(s)},handleTouchEvent:function(e){e.preventDefault();var t=e.changedTouches[0];if(e.type=="touchstart"){if(this.touchCount>=this.maxTouches)return;this.touchCount+=1,this.touchMap[t.identifier]=!0}else if(e.type=="touchend"){if(this.touchMap[t.identifier]==undefined)return;delete this.touchMap[t.identifier],this.touchCount-=1}else if(this.touchMap[t.identifier]==undefined)return;var r=e.currentTarget.offsetLeft*-1+e.currentTarget.offsetParent.offsetLeft*-1,i=e.currentTarget.offsetTop*-1+e.currentTarget.offsetParent.offsetTop*-1,s;r=(r+t.clientX)*this.ratio,i=(i+t.clientY)*this.ratio;switch(e.type){case"touchstart":s=n.TOUCH_START;break;case"touchmove":s=n.TOUCH_MOVE;break;case"touchend":s=n.TOUCH_END;break;default:return}var o=new n(s,!1,!1,r,i,this.container);this.dispatchEvent(o)},handleKeyboardEvent:function(e){e.preventDefault();var t,n=this.getKeyFromKeyCode(e.keyCode);if(n==undefined)return;switch(e.type){case"keydown":t=r.KEY_DOWN;break;case"keyup":t=r.KEY_UP}var i=new r(t,!1,!1,n);this.dispatchEvent(i)},getKeyFromKeyCode:function(e){switch(e){case 32:return i.KEY_SPACE;case 37:return i.KEY_LEFT;case 38:return i.KEY_UP;case 39:return i.KEY_RIGHT;case 40:return i.KEY_DOWN}}});return u}),n("minibot/system",["minibot/display/html/CanvasScene"],function(e){function r(e,t){for(var n in t)e[n]=t[n];return e}(function(){var e=0,t=["webkit","moz"];for(var n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),s=window.setTimeout(function(){t(r+i)},i);return e=r+i,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})})();var t=(navigator.userAgent||navigator.vendor||window.opera).toLowerCase(),n=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)),i={};return i.onUpdate=null,i.onRender=null,i.lastTime=null,i.isRunning=!1,i.isRendering=!1,i.animationFrameId=null,i.handleAnimationFrame=function(e){if(!i.isRunning)return;if(i.isRendering)return;i.isRendering=!0,i.animationFrameId=window.requestAnimationFrame(i.handleAnimationFrame.bind(this));var t=0;i.lastTime!=null&&(t=e-i.lastTime),i.onUpdate!=null&&i.onUpdate(t),i.onRender!=null&&i.onRender(t),i.lastTime=e,i.isRendering=!1},i.SetUpdateCallback=function(e){i.onUpdate=e},i.SetRenderCallback=function(e){i.onRender=e},i.Run=function(){if(i.isRunning)return;i.isRunning=!0,i.animationFrameId=window.requestAnimationFrame(i.handleAnimationFrame.bind(i))},i.Stop=function(){if(!i.isRunning)return;window.cancelAnimationFrame(i.animationFrameId),i.isRunning=!1},i.CreateScene=function(t){var n=new e(t);return n},i.GetWrapperType=function(){return i.WrapperType.BROWSER},i.GetBrowserType=function(){},i.GetPlatformType=function(){return n?i.PlatformType.MOBILE:i.PlatformType.DESKTOP},i.GetPlatformName=function(){var e=i.PlatformName.OTHER;return n&&(/(ipad|iphone|ipod)/g.test(t)?e=i.PlatformName.IOS:/(android)/g.test(t)&&(e=i.PlatformName.ANDROID)),e},i.WrapperType={BROWSER:"Browser",NATIVE:"Native"},i.BrowserType={SAFARI:"Safari",FIREFOX:"Firefox",CHROME:"Chrome",EXPLORER:"Explorer",OPERA:"Opera"},i.PlatformType={DESKTOP:"Desktop",MOBILE:"Mobile"},i.PlatformName={OSX:"OSX",WINDOWS:"Windows",LINUX:"Linux",ANDROID:"Android",IOS:"iOS",OTHER:"Other"},i}),n("minibot/core/Manager",[],function(){var e=Class.create({initialize:function(t){if(e.instanceMap[t]!=null)throw new Error(e.MULTITON_MSG);e.instanceMap[t]=this}});return Object.extend(e,{instanceMap:[],MULTITON_MSG:"Manager instance for this Multiton key already constructed!",getInstance:function(t){return null==t?null:(e.instanceMap[t]==null&&(e.instanceMap[t]=new e(t)),e.instanceMap[t])},hasCore:function(t){return e.instanceMap[t]!=null},removeCore:function(t){if(e.instanceMap[t]==null)return;delete e.instanceMap[t]}}),e}),n("minibot/display/scene/Animation",["minibot/display/scene/SceneDisplayObject"],function(e){var t=Class.create(e,{animation:null,currentFrame:0,currentSprite:null,currentDelay:null,time:0,loops:0,playing:!1,initialize:function($super,e,n,r){$super(),this.loops=t.INFINITE_LOOPS,this.setAnimation(e,n,r)},setAnimation:function(e,n,r){this.playing=n==undefined||n,r==undefined?this.loops==t.INFINITE_LOOPS:this.loops=r,this.currentFrame=0,this.time=0,this.animation=e,this.setupFrame()},setupFrame:function(){if(this.animation==null)return;this.currentSprite=this.animation.getSprite(this.currentFrame),this.currentDelay=this.animation.getDelay(this.currentFrame),this.w==0&&(this.w=this.currentSprite.w),this.h==0&&(this.h=this.currentSprite.h)},stop:function(){this.playing=!1,this.currentFrame=0,this.time=0,this.setupFrame()},play:function(e){this.playing=!0,e==undefined?this.loops==t.INFINITE_LOOPS:this.loops=e},isPlaying:function(){return this.playing},render:function(e,n,r){if(this.animation==null)return;if(this.playing){this.time+=e;while(this.time>=this.currentDelay){if(this.loops!=t.INFINITE_LOOPS&&this.animation.atEnd(this.currentFrame)){if(this.loops==0){this.stop(),this.setupFrame();break}this.loops-=1}this.time-=this.currentDelay,this.currentFrame=this.animation.nextFrame(this.currentFrame),this.setupFrame()}}try{this.scene.drawImage(this.currentSprite.img,this.currentSprite.x,this.currentSprite.y,this.currentSprite.w,this.currentSprite.h,this.x+n,this.y+r,this.w,this.h)}catch(i){console.log("Animation: Rendering Fatal Error")}}});return t.INFINITE_LOOPS=-1,t}),n("minibot/event/ButtonEvent",["./BaseEvent"],function(e){var t=Class.create(e,{displayObject:null,initialize:function($super,e,t,n,r){$super(e,t,n),this.displayObject=r}});return t.SELECT="buttonSelect",t}),n("minibot/display/scene/Button",["./SceneDisplayObject","minibot/event/MouseEvent","minibot/event/TouchEvent","minibot/event/ButtonEvent"],function(e,t,n,r){var i=Class.create(e,{upState:null,downState:null,overState:null,currentState:null,states:null,isDown:!1,isOver:!1,mouseMoveCallback:null,mouseUpCallback:null,touchMoveCallback:null,touchEndCallback:null,initialize:function($super,e,t,n){$super(),e!=undefined&&(this.upState=e),t!=undefined&&(this.downState=t),n!=undefined&&(this.overState=n),this.currentState=this.upState,this.w=this.upState.w,this.h=this.upState.h,this.states=new Array,this.upState!=null&&this.states.push(this.upState),this.downState!=null&&this.states.push(this.downState),this.overState!=null&&this.states.push(this.overState)},render:function(e,t,n){this.currentState.render(e,this.x+t,this.y+n)},onAddedToScene:function($super){$super(),this.states.each(function(e){e.root=this.parent,e.parent=this,e.scene=this.scene,e.onAddedToScene()}.bind(this))},dispatchEvent:function($super,e){return this.isDown?e.type==t.MOUSE_UP?(this.isDown=!1,this.mouseMoveCallback&&(this.parent.removeEventListener(t.MOUSE_MOVE,this.mouseMoveCallback),this.mouseMoveCallback=null),this.mouseUpCallback&&(this.parent.removeEventListener(t.MOUSE_UP,this.mouseUpCallback),this.mouseUpCallback=null),this.currentState=this.upState,this.select.bind(this).defer(e)):e.type==n.TOUCH_END&&(this.isDown=!1,this.touchMoveCallback&&(this.parent.removeEventListener(n.TOUCH_MOVE,this.touchMoveCallback),this.touchMoveCallback=null),this.touchUpCallback&&(this.parent.removeEventListener(n.TOUCH_END,this.touchEndCallback),this.touchEndCallback=null),this.currentState=this.upState,this.select.bind(this).defer(e)):e.type==t.MOUSE_DOWN?(this.currentState=this.downState,this.isDown=!0,this.mouseMoveCallback||(this.mouseMoveCallback=this.handleMouseMove.bindAsEventListener(this),this.parent.addEventListener(t.MOUSE_MOVE,this.mouseMoveCallback)),this.mouseUpCallback||(this.mouseUpCallback=this.handleMouseUp.bindAsEventListener(this),this.parent.addEventListener(t.MOUSE_UP,this.mouseUpCallback))):e.type==n.TOUCH_START?(this.currentState=this.downState,this.isDown=!0,this.touchMoveCallback||(this.touchMoveCallback=this.handleTouchMove.bindAsEventListener(this),this.parent.addEventListener(n.TOUCH_MOVE,this.touchMoveCallback)),this.touchEndCallback||(this.touchEndCallback=this.handleTouchEnd.bindAsEventListener(this),this.parent.addEventListener(n.TOUCH_END,this.touchEndCallback))):e.type==t.MOUSE_MOVE?(this.currentState=this.overState,this.mouseMoveCallback||(this.mouseMoveCallback=this.handleMouseMove.bindAsEventListener(this),this.parent.addEventListener(t.MOUSE_MOVE,this.mouseMoveCallback))):e.type==n.TOUCH_MOVE?(this.currentState=this.overState,this.touchMoveCallback||(this.touchMoveCallback=this.handleTouchMove.bindAsEventListener(this),this.parent.addEventListener(n.TOUCH_MOVE,this.touchMoveCallback))):e.type==n.TOUCH_END&&(this.currentState=this.upState,this.touchMoveCallback&&(this.parent.removeEventListener(n.TOUCH_MOVE,this.touchMoveCallback),this.touchMoveCallback=null)),$super(e)},handleMouseMove:function(e){this.isOver=this.isEventOver(e),this.isOver&&this.isDown?this.currentState=this.downState:this.isOver?this.currentState=this.overState:this.isDown?this.currentState=this.upState:(this.currentState=this.upState,this.mouseMoveCallback&&(this.parent.removeEventListener(t.MOUSE_MOVE,this.mouseMoveCallback),this.mouseMoveCallback=null))},handleTouchMove:function(e){this.isOver=this.isEventOver(e),this.isOver&&this.isDown?this.currentState=this.downState:this.isOver?this.currentState=this.overState:this.isDown?this.currentState=this.upState:(this.currentState=this.upState,this.touchMoveCallback&&(this.parent.removeEventListener(n.TOUCH_MOVE,this.touchMoveCallback),this.touchMoveCallback=null))},isEventOver:function(e){var t=this.getSceneX(),n=this.getSceneY();return e.x>=t&&e.x<=t+this.w&&e.y>=n&&e.y<=n+this.h},handleMouseUp:function(e){this.currentState=this.upState,this.isDown=!1,this.mouseMoveCallback&&(this.parent.removeEventListener(t.MOUSE_MOVE,this.mouseMoveCallback),this.mouseMoveCallback=null),this.mouseUpCallback&&(this.parent.removeEventListener(t.MOUSE_UP,this.mouseUpCallback),this.mouseUpCallback=null)},handleTouchEnd:function(e){this.currentState=this.upState,this.isDown=!1,this.touchMoveCallback&&(this.parent.removeEventListener(n.TOUCH_MOVE,this.touchMoveCallback),this.touchMoveCallback=null),this.touchUpCallback&&(this.parent.removeEventListener(n.TOUCH_END,this.touchEndCallback),this.touchEndCallback=null)},select:function(e){var t=e.x,n=e.y,i=r.SELECT,s=new r(i,!1,!1,this);this.dispatchEvent(s)}});return i}),n("minibot/graphics/Pattern",[],function(){var e=Class.create({sprite:null,pattern:null,repeat:null,initialize:function(t,n){n==undefined&&(n=e.REPEAT),this.repeat=n,this.type=e.TYPE,this.sprite=t},hasPattern:function(){return this.pattern!=null},setPattern:function(e){this.pattern=e},getPattern:function(){return this.pattern}});return e.TYPE="pattern",e.REPEAT="repeat",e.REPEAT_Y="repeat-y",e.REPEAT_X="repeat-x",e}),n("minibot/display/scene/Rect",["./SceneDisplayObject","minibot/graphics/Color","minibot/graphics/Pattern"],function(e,t,n){var r=Class.create(e,{mode:null,fillColor:null,fillPattern:null,strokeColor:null,initialize:function($super,e,r,i,s,o){$super(),this.w=e,this.h=r,this.mode=i;if(s!=undefined)if(s.type==t.TYPE)this.fillColor=s;else if(s.type=n.TYPE)this.fillPattern=s;o!=undefined&&(this.strokeColor=o)},render:function(e,t,n){this.fillColor!=null&&this.scene.setFillColor(this.fillColor),this.fillPattern!=null&&this.scene.setFillPattern(this.fillPattern),this.scene.drawRect(this.mode,this.x+t,this.y+n,this.w,this.h)}});return r}),n("minibot/display/scene/Sprite",["minibot/display/scene/SceneDisplayObject"],function(e){var t=Class.create(e,{sprite:null,composite:null,initialize:function($super,e){$super(),this.sprite=e,this.w=e.w,this.h=e.h},render:function(e,t,n){try{this.scene.drawImage(this.sprite.img,this.sprite.x,this.sprite.y,this.sprite.w,this.sprite.h,this.x+t,this.y+n,this.w,this.h)}catch(r){console.log("SpriteObject: Fatal Error")}}});return t}),n("minibot/display/scene/Text",["minibot/display/scene/SceneDisplayObject"],function(e){var t=Class.create(e,{text:"",style:null,initialize:function($super,e,t){$super(),this.text=e,t!=undefined&&(this.style=t)},setStyle:function(){},getText:function(){return this.text},getMetrics:function(){return this.metrics},setText:function(e){this.text=e},render:function(e,t,n){this.scene.drawText("",this.text,this.style,this.x+t,this.y+n)}});return t}),n("minibot/display/scene/TextStyle",["minibot/graphics/Color"],function(e){var t=Class.create({family:null,size:null,align:null,color:null,weight:null,initialize:function(e,t,n,r,i){this.family=e,this.size=t,this.color=n,this.align=r,this.weight=i?i:""},getFamily:function(){return this.family},getSize:function(){return this.size},getColor:function(){return this.color},getAlign:function(){return this.align},getWeight:function(){return this.weight}});return t}),n("minibot/event/HtmlEvent",function(){}),n("minibot/display/html/HtmlElement",["minibot/display/DisplayObject","minibot/event/HtmlEvent"],function(e,t){var n=Class.create(e,{element:null,children:null,isInDOM:!1,htmlListeners:null,initialize:function($super){$super(),arguments[1]!=undefined?typeof arguments[1]=="string"?this.element=new Element(arguments[1]):this.element=arguments[1]:this.element=new Element("div"),this.element==undefined,this.htmlListeners={},this.children=new Array,this.writeAttribute=this.element.writeAttribute.bind(this.element),this.readAttribute=this.element.readAttribute.bind(this.element),this.hide=this.element.hide.bind(this.element),this.show=this.element.show.bind(this.element)},addChild:function(e){this.element.insert(e.element),this.children.push(e),this.isInDOM&&e.onAddedToDOM()},removeChild:function(e){var t;for(var n=0;n<this.children.length;n++)t=this.children[n],e===t&&(this.children.splice(n,1),e.element.remove(),e.onRemovedFromDOM())},onAddedToDOM:function($super){this.isInDOM=!0;var e;for(var t=0;t<this.children.length;t++)e=this.children[t],e.onAddedToDOM()},isHtmlObject:function(){return!0},addToDOM:function(e){e.insert(this.element),this.onAddedToDOM()},onRemovedFromDOM:function(){},addEventListener:function($super,e,n){if(this.htmlListeners[e]==undefined){var r=null;switch(e){case t.CLICK:r="click";break;case t.FOCUS:r="focus";break;case t.BLUR:r="blur";break;case t.MOUSE_DOWN:r="mousedown";break;case t.MOUSE_MOVE:r="mousemove";break;case t.MOUSE_UP:r="mouseup";break;case t.KEY_DOWN:r="keydown";break;case t.KEY_UP:r="keyup";break;case t.DRAG_ENTER:r="dragenter";break;case t.DRAG_EXIT:r="dragexit";break;case t.DRAG_OVER:r="dragover";break;case t.DROP:r="drop";break;default:}r!=null&&(this.htmlListeners[e]=this.handleHtmlEvent.bindAsEventListener(this,e),this.element.observe(r,this.htmlListeners[e]))}$super(e,n)},handleHtmlEvent:function(e,n){this.dispatchEvent(new t(n,e))}});return n}),n("minibot/engine/Engine",["minibot/event/EventDispatcher"],function(e){var t=Class.create(e,{systems:null,systemsByType:null,objects:null,objectsByType:null,camera:null,player:null,resources:null,updateOrder:null,initialize:function($super){$super(),this.resources={},this.systems=[],this.systemsByType={},this.objects=[],this.objectsByType={}},update:function(e){for(var t=0;t<this.updateOrder.length;t++)this.systemsByType[this.updateOrder[t]].update(e)},render:function(e){},renderPhysics:function(e){},setUpdateOrder:function(e){this.updateOrder=e},addSystem:function(e){var t=e.getType();if(this.systemsByType[t]!=undefined)return;this.systems.push(e),this.systemsByType[t]=e,e.setEngine(this),e.onAddedToEngine()},removeSystem:function(){},addObject:function(e){this.objects.push(e);var t=e.getType();this.objectsByType[t]==undefined&&(this.objectsByType[t]=[]),this.objectsByType[t].push(e);for(var n=0;n<this.systems.length;n++)this.systems[n].addObject(e);e.setEngine(this),e.onAddedToEngine()},removeObject:function(){},getResources:function(){return this.resources},getResource:function(e,t){return this.resources[e]==undefined?null:this.resources[e][t]==undefined?null:this.resources[e][t]},addResource:function(e,t){this.resources[e]==undefined&&(this.resources[e]={}),this.resources[e][t]=null},onResourcesLoaded:function(){var e;for(e=0;e<this.systems.length;e++)this.systems[e].onResourcesLoaded();for(e=0;e<this.objects.length;e++)this.objects[e].onResourcesLoaded()}});return t}),n("minibot/event/EngineEvent",["./BaseEvent"],function(e){var t=Class.create(e,{object:null,component:null,data:null,initialize:function($super,e,t,n,r){$super(e,!1,!1),this.object=t,this.component=n,this.data=r}});return t}),n("minibot/engine/EngineComponent",["minibot/event/EngineEvent"],function(e){var t=Class.create({type:null,object:null,system:null,eventQueue:null,initialize:function(e){this.type=e,this.eventQueue=[]},getType:function(){return this.type},setProperty:function(e,t){this.object.setProperty(e,t)},getProperty:function(e){return this.object.getProperty(e)},hasProperty:function(e){return this.object.hasProperty(e)},setObject:function(e){this.object=e},getObject:function(){return this.object},onAddedToObject:function(){},setSystem:function(e){this.system=e},getSystem:function(){return this.system},onAddedToSystem:function(){},buildEvent:function(e,t){return this.object.buildEvent(e,t,this)},queueEvent:function(e){this.eventQueue.push(e)},flushEventQueue:function(){while(this.eventQueue.length)this.dispatchEvent(this.eventQueue.pop())},dispatchEvent:function(e){this.object.dispatchEvent(e)},addEventListener:function(e,t){this.object.addEventListener(e,t)},addResource:function(e,t){if(this.system==null)return;this.system.addResource(e,t)},getResource:function(e,t){if(this.system==null)return;return this.system.getResource(e,t)},onResourcesLoaded:function(){},update:function(e){}});return t}),n("minibot/engine/EngineFactory",function(){}),n("minibot/engine/EngineObject",["minibot/event/EventDispatcher","minibot/event/EngineEvent"],function(e,t){var n=Class.create(e,{type:null,components:null,data:null,engine:null,initialize:function($super,e,t){$super(),this.type=e,this.components={},t==undefined&&(t={}),this.data=t},getType:function(){return this.type},addComponent:function(e){var t=e.getType();this.components[t]==undefined&&(this.components[t]=e,e.setObject(this),e.onAddedToObject())},removeComponent:function(e){},setEngine:function(e){this.engine=e},getEngine:function(){return this.engine},onAddedToEngine:function(){},onResourcesLoaded:function(){for(var e in this.components)this.components[e].onResourcesLoaded()},getComponent:function(e){return this.components[e]!=undefined?this.components[e]:null},hasComponent:function(e){return this.components[e]!=undefined},update:function(e){for(var t in this.components)this.components[t].update(e)},setProperty:function(e,t){this.data[e]=t},getProperty:function(e){return this.data[e]},hasProperty:function(e){return this.data[e]!=undefined},buildEvent:function(e,n,r){return r==undefined&&(r=null),new t(e,this,r,n)}});return n}),n("minibot/engine/EngineSystem",[],function(){var e=Class.create({type:null,components:null,componentsByObject:null,engine:null,initialize:function(e){this.type=e,this.components=[],this.componentsByObject={}},getType:function(){return this.type},addObject:function(e){if(e.hasComponent(this.type)){var t=e.getComponent(this.type);return this.components.push(t),this.componentsByObject[e]=t,t.setSystem(this),t.onAddedToSystem(),t}return null},addResource:function(e,t){if(!this.engine)return;this.engine.addResource(e,t)},getResource:function(e,t){if(!this.engine)return;return this.engine.getResource(e,t)},removeObject:function(e){},setEngine:function(e){this.engine=e},getEngine:function(){return this.engine},onAddedToEngine:function(){},onResourcesLoaded:function(){},update:function(e){},updateComponents:function(e){for(var t=0;t<this.components.length;t++)this.components[t].update(e)}});return e}),n("minibot/engine/component/DisplayComponent",["minibot/engine/EngineComponent"],function(e){var t=Class.create(e,{scene:null,initialize:function($super,e){$super(e)},update:function(e){},onAddedToSystem:function(){this.scene=this.getSystem().getScene()},render:function(e,t,n,r){},getLayers:function(){return[]},isVisible:function(){return!0}});return t}),n("minibot/engine/component/PhysicsComponent",["minibot/engine/EngineComponent"],function(e){var t=Class.create(e,{});return t}),n("minibot/engine/component/InputComponent",["minibot/engine/EngineComponent"],function(e){var t=Class.create(e,{});return t}),n("minibot/engine/system/DisplaySystem",["minibot/engine/EngineSystem"],function(e){var t=Class.create(e,{scene:null,layers:null,initialize:function($super,e,t){$super(e),this.scene=t,this.layers=new Array},update:function(e){this.updateComponents(e)},addObject:function($super,e){var t=$super(e);if(t==null)return null;var n=t.getLayers();for(var r=0;r<n.length;r++)this.addToLayer(t,n[r])},addToLayer:function(e,t){while(!this.layers[t])this.layers.push([]);this.layers[t].push(e)},onAddedToEngine:function(){},getScene:function(){return this.scene},getCamera:function(){return this.engine.getCamera()},render:function(e){var t=this.getCamera(),n=t.getProperty("x")*-1,r=t.getProperty("y")*-1,i,s,o,u;for(i=0;i<this.layers.length;i++){o=this.layers[i];for(s=0;s<o.length;s++){u=o[s];if(!u.isVisible())continue;u.render(e,i,n,r)}}}});return t}),n("minibot/geom/Vector2",[],function(){var e=Class.create({x:0,y:0,initialize:function(e,t){this.x=e||0,this.y=t||0},reset:function(e,t){return this.x=e,this.y=t,this},toString:function(e){e=e||3;var t=Math.pow(10,e);return"["+Math.round(this.x*t)/t+", "+Math.round(this.y*t)/t+"]"},clone:function(){return new e(this.x,this.y)},copyTo:function(e){e.x=this.x,e.y=this.y},copyFrom:function(e){this.x=e.x,this.y=e.y},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},magnitudeSquared:function(){return this.x*this.x+this.y*this.y},normalise:function(){return this.normailize()},normalize:function(){var e=this.magnitude();return e==0?this:(this.x=this.x/e,this.y=this.y/e,this)},reverse:function(){return this.x=-this.x,this.y=-this.y,this},plusEq:function(e){return this.x+=e.x,this.y+=e.y,this},plusNew:function(t){return new e(this.x+t.x,this.y+t.y)},minusEq:function(e){return this.x-=e.x,this.y-=e.y,this},minusNew:function(t){return new e(this.x-t.x,this.y-t.y)},multiplyEq:function(e){return this.x*=e,this.y*=e,this},multiplyNew:function(e){var t=this.clone();return t.multiplyEq(e)},divideEq:function(e){return this.x/=e,this.y/=e,this},divideNew:function(e){var t=this.clone();return t.divideEq(e)},dot:function(e){return this.x*e.x+this.y*e.y},angle:function(t){return Math.atan2(this.y,this.x)*(t?1:e.TO_DEGREES)},rotate:function(t,n){var r=Math.cos(t*(n?1:e.TO_RADIANS)),i=Math.sin(t*(n?1:e.TO_RADIANS));return e.temp.copyFrom(this),this.x=e.temp.x*r-e.temp.y*i,this.y=e.temp.x*i+e.temp.y*r,this},equals:function(e){return this.x==e.x&&this.y==e.x},isCloseTo:function(t,n){return this.equals(t)?!0:(e.temp.copyFrom(this),e.temp.minusEq(t),e.temp.magnitudeSquared()<n*n)},rotateAroundPoint:function(t,n,r){e.temp.copyFrom(this),e.temp.minusEq(t),e.temp.rotate(n,r),e.temp.plusEq(t),this.copyFrom(e.temp)},isMagLessThan:function(e){return this.magnitudeSquared()<e*e},isMagGreaterThan:function(e){return this.magnitudeSquared()>e*e}});return e.TO_DEGREES=180/Math.PI,e.TO_RADIANS=Math.PI/180,e.temp=new e,e}),n("minibot/geom/Rectangle",[],function(){var e=Class.create({x:0,y:0,w:0,h:0,initialize:function(e,t,n,r){this.x=e,this.y=t,this.w=n,this.h=r}});return e}),n("minibot/resource/Resource",[],function(){var e=Class.create({initialize:function(e){this.id=e},id:null,loaded:!1,load:function(e,t){this.loaded=!0,t.defer()},isLoaded:function(){return this.loaded}});return e}),n("minibot/resource/ResourceManager",["minibot/core/Manager"],function(e){var t=Class.create(e,{typeOrder:null,typeCount:null,typeMap:null,resourceMap:null,resourceCount:0,loadedCount:0,typeIndex:null,typeLoadedCount:0,initialize:function($super,e){$super(e),this.typeOrder=[],this.typeCount=[],this.typeMap={},this.resourceMap={}},addType:function(e,t){this.typeOrder.push(e),this.typeCount.push(0),this.typeMap[e]=t,this.resourceMap[e]={}},addResource:function(e,t,n){if(this.typeMap[e]==undefined)return;var r=this.typeMap[e],i=new r(t,n);this.resourceMap[e][t]=i,this.resourceCount+=1;for(var s=0;s<this.typeOrder.length;s++)if(e==this.typeOrder[s]){this.typeCount[s]+=1;break}},loadAll:function(e,t){this.progressCallback=e,this.completeCallback=t,this.typeIndex=null,this.loadNextType()},loadNextType:function(){this.typeIndex==null?this.typeIndex=0:this.typeIndex+=1;if(this.typeIndex>=this.typeOrder.length){this.completeCallback.bind(this).defer();return}this.typeLoadedCount=0;var e=this.typeOrder[this.typeIndex],t,n,r=0;t=this.resourceMap[e];for(n in t)this.loadResource(e,n),r++;r==0&&this.loadNextType()},loadResource:function(e,t){var n=this.resourceMap[e][t];n.isLoaded()?this.handleResourceLoaded():n.load(this,this.handleResourceLoaded.bind(this))},handleResourceLoaded:function(){this.typeLoadedCount+=1;var e=Number(1/this.resourceCount);this.progressCallback(e),this.typeLoadedCount>=this.typeCount[this.typeIndex]&&this.loadNextType.bind(this).defer()},getResource:function(e,t){return this.resourceMap[e]==undefined?null:this.resourceMap[e][t]==undefined?null:this.resourceMap[e][t]}});return Object.extend(t,{getInstance:function(n){e.hasCore(n)||new t(n);var r=e.getInstance(n);return r}}),t}),n("minibot/resource/ImageResource",["minibot/resource/Resource"],function(e){var t=Class.create(e,{src:null,img:null,initialize:function($super,e,t){$super(e),t.src!=undefined&&(this.src=t.src)},load:function(e,t){this.loaded=!0,this.src!=null?(this.img=new Image,this.img.addEventListener("load",this.handleLoadImageSuccess.bindAsEventListener(this,t),!1),this.img.addEventListener("error",this.handleLoadImageFailure.bindAsEventListener(this,t),!1),this.img.src=this.src):t()},handleLoadImageSuccess:function(e,t){t()},handleLoadImageFailure:function(e,t){console.log("ImageResource: Failed to load image."),t()}});return t.TYPE=1,t}),n("minibot/resource/SpriteResource",["minibot/resource/Resource","minibot/resource/ImageResource"],function(e,t){var n=Class.create(e,{imageId:null,imageResource:null,img:null,x:0,y:0,w:-1,h:-1,initialize:function($super,e,t){$super(e),t!=undefined&&(t.image_id!=undefined?this.imageId=t.image_id:t.imageId!=undefined&&(this.imageId=t.imageId),t.x!=undefined&&(this.x=t.x),t.y!=undefined&&(this.y=t.y),t.w!=undefined&&(this.w=t.w),t.h!=undefined&&(this.h=t.h))},load:function(e,n){try{this.imageResource=e.getResource(t.TYPE,this.imageId),this.img=this.imageResource.img,this.w==-1&&(this.w=this.img.width),this.h==-1&&(this.h=this.img.height),this.loaded=!0}catch(r){console.log("ERROR")}n()}});return n.TYPE=2,n}),n("minibot/resource/AnimationResource",["minibot/resource/Resource","minibot/resource/SpriteResource"],function(e,t){var n=Class.create(e,{numberOfFrames:0,sprites:null,spriteIds:null,delays:null,initialize:function($super,e,t){$super(e),this.spriteIds=[],this.delays=[];if(t.frames!=undefined)for(var n=0;n<t.frames.length;n++)this.spriteIds.push(t.frames[n].sprite_id),this.delays.push(t.frames[n].delay);this.numberOfFrames=this.spriteIds.length,this.sprites=[]},load:function(e,n){for(var r=0;r<this.spriteIds.length;r++){var i=e.getResource(t.TYPE,this.spriteIds[r]);this.sprites.push(i)}this.loaded=!0,n()},addFrame:function(e,t){this.sprites.push_back(e),this.delays.push_back(t),this.numberOfFrames++},getSprite:function(e){return this.sprites[e]},getDelay:function(e){return this.delays[e]},nextFrame:function(e){return(e+1)%this.numberOfFrames},atEnd:function(e){return e+1==this.numberOfFrames}});return n.TYPE=3,n}),n("minibot",["require","minibot/system","minibot/core/Manager","minibot/display/DisplayObject","minibot/display/scene/SceneDisplayObject","minibot/display/scene/Animation","minibot/display/scene/Button","minibot/display/scene/Container","minibot/display/scene/Rect","minibot/display/scene/Sprite","minibot/display/scene/Scene","minibot/display/scene/Text","minibot/display/scene/TextStyle","minibot/display/html/HtmlElement","minibot/display/html/CanvasScene","minibot/engine/Engine","minibot/engine/EngineComponent","minibot/engine/EngineFactory","minibot/engine/EngineObject","minibot/engine/EngineSystem","minibot/engine/component/DisplayComponent","minibot/engine/component/PhysicsComponent","minibot/engine/component/InputComponent","minibot/engine/system/DisplaySystem","minibot/event/EventDispatcher","minibot/event/BaseEvent","minibot/event/MouseEvent","minibot/event/TouchEvent","minibot/event/ButtonEvent","minibot/event/EngineEvent","minibot/event/KeyboardEvent","minibot/event/enum/Keyboard","minibot/geom/Vector2","minibot/geom/Rectangle","minibot/graphics/Color","minibot/graphics/Pattern","minibot/resource/Resource","minibot/resource/ResourceManager","minibot/resource/AnimationResource","minibot/resource/ImageResource","minibot/resource/SpriteResource","minibot/system"],function(e){var t={},n,r,i,s,o,u,a,f;return t.system=e("minibot/system"),n={},n.Manager=e("minibot/core/Manager"),r={},r.DisplayObject=e("minibot/display/DisplayObject"),r.scene={},r.scene.SceneDisplayObject=e("minibot/display/scene/SceneDisplayObject"),r.scene.Animation=e("minibot/display/scene/Animation"),r.scene.Button=e("minibot/display/scene/Button"),r.scene.Container=e("minibot/display/scene/Container"),r.scene.Rect=e("minibot/display/scene/Rect"),r.scene.Sprite=e("minibot/display/scene/Sprite"),r.scene.Scene=e("minibot/display/scene/Scene"),r.scene.Text=e("minibot/display/scene/Text"),r.scene.TextStyle=e("minibot/display/scene/TextStyle"),r.html={},r.html.HtmlElement=e("minibot/display/html/HtmlElement"),r.html.CanvasScene=e("minibot/display/html/CanvasScene"),i={},i.Engine=e("minibot/engine/Engine"),i.EngineComponent=e("minibot/engine/EngineComponent"),i.EngineFactory=e("minibot/engine/EngineFactory"),i.EngineObject=e("minibot/engine/EngineObject"),i.EngineSystem=e("minibot/engine/EngineSystem"),i.component={},i.component.DisplayComponent=e("minibot/engine/component/DisplayComponent"),i.component.PhysicsComponent=e("minibot/engine/component/PhysicsComponent"),i.component.InputComponent=e("minibot/engine/component/InputComponent"),i.system={},i.system.DisplaySystem=e("minibot/engine/system/DisplaySystem"),s={},s.EventDispatcher=e("minibot/event/EventDispatcher"),s.BaseEvent=e("minibot/event/BaseEvent"),s.MouseEvent=e("minibot/event/MouseEvent"),s.TouchEvent=e("minibot/event/TouchEvent"),s.ButtonEvent=e("minibot/event/ButtonEvent"),s.EngineEvent=e("minibot/event/EngineEvent"),s.KeyboardEvent=e("minibot/event/KeyboardEvent"),s.enum={},s.enum.Keyboard=e("minibot/event/enum/Keyboard"),o={},o.Vector2=e("minibot/geom/Vector2"),o.Rectangle=e("minibot/geom/Rectangle"),u={},u.Color=e("minibot/graphics/Color"),u.Pattern=e("minibot/graphics/Pattern"),a={},a.Resource=e("minibot/resource/Resource"),a.ResourceManager=e("minibot/resource/ResourceManager"),a.AnimationResource=e("minibot/resource/AnimationResource"),a.ImageResource=e("minibot/resource/ImageResource"),a.SpriteResource=e("minibot/resource/SpriteResource"),f={},f=e("minibot/system"),t.core=n,t.display=r,t.engine=i,t.event=s,t.geom=o,t.graphics=u,t.resource=a,t.system=f,t}),t("minibot")})