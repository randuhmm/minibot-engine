/**
 * almond 0.2.0 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

(function(e,t){typeof define=="function"&&define.amd?define(t):e.minibot=t()})(this,function(){var e,t,n;return function(r){function p(e,t){var n,r,i,s,o,u,a,f,c,h,p=t&&t.split("/"),d=l.map,v=d&&d["*"]||{};if(e&&e.charAt(0)==="."&&t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(f=0;f<e.length;f+=1){h=e[f];if(h===".")e.splice(f,1),f-=1;else if(h===".."){if(f===1&&(e[2]===".."||e[0]===".."))break;f>0&&(e.splice(f-1,2),f-=2)}}e=e.join("/")}if((p||v)&&d){n=e.split("/");for(f=n.length;f>0;f-=1){r=n.slice(0,f).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=f;break}}}if(s)break;!u&&v&&v[r]&&(u=v[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function d(e,t){return function(){return s.apply(r,h.call(arguments,0).concat([e,t]))}}function v(e){return function(t){return p(t,e)}}function m(e){return function(t){a[e]=t}}function g(e){if(f.hasOwnProperty(e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!a.hasOwnProperty(e)&&!c.hasOwnProperty(e))throw new Error("No "+e);return a[e]}function y(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function b(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=[].slice;o=function(e,t){var n,r=y(e),i=r[0];return e=r[1],i&&(i=p(i,t),n=g(i)),i?n&&n.normalize?e=n.normalize(e,v(t)):e=p(e,t):(e=p(e,t),r=y(e),i=r[0],e=r[1],i&&(n=g(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return d(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:b(e)}}},i=function(e,t,n,i){var s,l,h,p,v,y=[],b;i=i||e;if(typeof n=="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(v=0;v<t.length;v+=1){p=o(t[v],i),l=p.f;if(l==="require")y[v]=u.require(e);else if(l==="exports")y[v]=u.exports(e),b=!0;else if(l==="module")s=y[v]=u.module(e);else if(a.hasOwnProperty(l)||f.hasOwnProperty(l)||c.hasOwnProperty(l))y[v]=g(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,d(i,!0),m(l),{}),y[v]=a[l]}}h=n.apply(a[e],y);if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!b)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){return typeof e=="string"?u[e]?u[e](t):g(o(e,t).f):(e.splice||(l=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},15),s)},s.config=function(e){return l=e,s},n=function(e,t,n){t.splice||(n=t,t=[]),f[e]=[e,t,n]},n.amd={jQuery:!0}}(),n("../lib/almond",function(){}),n("minibot/utils",[],function(){function e(e,t){for(var n in t)e[n]=t[n];return e}function t(e,t,n){var r=e.split("."),i=n||window,s,o,u;for(var a=0,f=r.length;a<f;a++)s=i,u=r[a],i=null==i[u]?i[u]={}:i[u];return null==t?i:s[u]=t}function n(n,r,i){n||(n={});var s=n.name,o=n.parent,u="function"==typeof o,a,f=n.scope||null,l;if("parent"in n&&!u)throw new TypeError("Class parent must be Function");u?a=Class.create(o,r):a=Class.create(r),i&&e(a,i);if(s){if("string"!=typeof s)throw new TypeError("Class name must be primitive string");t(s,a,f)}return a}return function(){var e=0,t=["ms","moz","webkit","o"];for(var n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),s=window.setTimeout(function(){t(r+i)},i);return e=r+i,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),{define:n,declare:t,decorate:e}}),n("minibot/system",["./utils"],function(){var e={};return e.onUpdate=null,e.onRender=null,e.lastTime=null,e.handleAnimationFrame=function(e){window.requestAnimationFrame(this.handleAnimationFrame.bind(this));var t=0;this.lastTime!=null&&(t=e-this.lastTime),this.onUpdate!=null&&this.onUpdate(t),this.onRender!=null&&this.onRender(t),this.lastTime=e},e.setUpdateCallback=function(t){e.onUpdate=t},e.setRenderCallback=function(t){e.onRender=t},e.run=function(){window.requestAnimationFrame(this.handleAnimationFrame.bind(this))},e}),n("minibot/core/Manager",[],function(){var e=Class.create({initialize:function(t){if(e.instanceMap[t]!=null)throw new Error(e.MULTITON_MSG);e.instanceMap[t]=this}});return Object.extend(e,{instanceMap:[],MULTITON_MSG:"Manager instance for this Multiton key already constructed!",getInstance:function(t){return null==t?null:(e.instanceMap[t]==null&&(e.instanceMap[t]=new e(t)),e.instanceMap[t])},hasCore:function(t){return e.instanceMap[t]!=null},removeCore:function(t){if(e.instanceMap[t]==null)return;delete e.instanceMap[t]}}),e}),n("minibot/event/EventDispatcher",[],function(){var e=Class.create({listeners:null,initialize:function(){this.listeners={}},addEventListener:function(e,t){var n;this.listeners[e]==undefined?(n=new Array,this.listeners[e]=n):n=this.listeners[e],n.push(t)},hasEventListener:function(e){return this.listeners[e]!=undefined},dispatchEvent:function(e){var t;if(this.listeners[e.type]==undefined)return!1;t=this.listeners[e.type],e.target=this;for(var n=0;n<t.length;n++){var r=t[n];return r(e),!0}},removeEventListener:function(e,t){var n;if(this.listeners[e]==undefined)return;n=this.listeners[e];var r=n.indexOf(t);if(r==-1)return;n.splice(r,1),n.length==0&&delete this.listeners[e]},removeAllEventListeners:function(){}});return e}),n("minibot/display/DisplayObject",["minibot/event/EventDispatcher"],function(e){var t=Class.create(e,{parent:null,initialize:function(e){e()},onAddedToParent:function(){}});return Object.extend(t,{AddResource:function(e,t,n){e.RESOURCES==undefined&&(e.RESOURCES={}),e.RESOURCES[t]==undefined&&(e.RESOURCES[t]={}),e.RESOURCES[t][n]=null},AddObject:function(e,t){e.OBJECTS==undefined&&(e.OBJECTS=[]),e.OBJECTS.push(t)},GetResource:function(e,t,n){return e.RESOURCES==undefined?null:e.RESOURCES[t]==undefined?null:e.RESOURCES[t][n]==undefined?null:e.RESOURCES[t][n]}}),t}),n("minibot/display/scene/SceneDisplayObject",["minibot/display/DisplayObject"],function(e){var t=Class.create(e,{x:0,y:0,w:0,h:0,root:null,scene:null,isVisible:!0,initialize:function(e){e()},render:function(e,t,n){},onAddedToScene:function(){},onRemovedFromScene:function(){},getSceneX:function(){var e=0;return this.parent!=null&&(e+=this.parent.getSceneX()),e+=this.x,e},getSceneY:function(){var e=0;return this.parent!=null&&(e+=this.parent.getSceneY()),e+=this.y,e},setRoot:function(e){this.root=e},setScene:function(e){this.scene=e},setWidth:function(e){this.w=e},setHeight:function(e){this.h=e},hide:function(){this.isVisible=!1},show:function(){this.isVisible=!0}});return t}),n("minibot/display/scene/Animation",["minibot/display/scene/SceneDisplayObject"],function(e){var t=Class.create(e,{animation:null,currentFrame:0,currentSprite:null,currentDelay:null,time:0,loops:0,playing:!1,initialize:function(e,n,r,i){e(),this.loops=t.INFINITE_LOOPS,this.setAnimation(n,r,i)},setAnimation:function(e,n,r){this.playing=n==undefined||n,r==undefined?this.loops==t.INFINITE_LOOPS:this.loops=r,this.currentFrame=0,this.time=0,this.animation=e,this.setupFrame()},setupFrame:function(){if(this.animation==null)return;this.currentSprite=this.animation.getSprite(this.currentFrame),this.currentDelay=this.animation.getDelay(this.currentFrame),this.w==0&&(this.w=this.currentSprite.w),this.h==0&&(this.h=this.currentSprite.h)},stop:function(){this.playing=!1,this.currentFrame=0,this.time=0,this.setupFrame()},play:function(e){this.playing=!0,e==undefined?this.loops==t.INFINITE_LOOPS:this.loops=e},isPlaying:function(){return this.playing},render:function(e,n,r){if(this.animation==null)return;if(this.playing){this.time+=e;while(this.time>=this.currentDelay){if(this.loops!=t.INFINITE_LOOPS&&this.animation.atEnd(this.currentFrame)){if(this.loops==0){this.stop(),this.setupFrame();break}this.loops-=1}this.time-=this.currentDelay,this.currentFrame=this.animation.nextFrame(this.currentFrame),this.setupFrame()}}try{this.scene.drawImage(this.currentSprite.img,this.currentSprite.x,this.currentSprite.y,this.currentSprite.w,this.currentSprite.h,this.x+n,this.y+r,this.w,this.h)}catch(i){console.log("Animation: Rendering Fatal Error")}}});return t.INFINITE_LOOPS=-1,t}),n("minibot/event/BaseEvent",[],function(){var e=Class.create({type:null,target:null,currentTarget:null,bubbles:null,cancelable:null,currentPhase:null,initialize:function(e,t,n){this.type=e,this.bubbles=t==undefined?!1:t,this.cancelable=n==undefined?!1:n},preventDefault:function(){}});return e}),n("minibot/event/MouseEvent",["./BaseEvent"],function(e){var t=Class.create(e,{x:null,y:null,displayObject:null,initialize:function(e,t,n,r,i,s,o){e(t,n,r),this.x=i,this.y=s,this.displayObject=o}});return t.CLICK="mouseClick",t.MOUSE_DOWN="mouseDown",t.MOUSE_UP="mouseUp",t.MOUSE_MOVE="mouseMove",t}),n("minibot/display/scene/Button",["./SceneDisplayObject","minibot/event/MouseEvent"],function(e,t){var n=Class.create(e,{upState:null,downState:null,overState:null,currentState:null,states:null,isDown:!1,isOver:!1,mouseMoveCallback:null,mouseUpCallback:null,initialize:function(e,t,n,r){e(),t!=undefined&&(this.upState=t),n!=undefined&&(this.downState=n),r!=undefined&&(this.overState=r),this.currentState=this.upState,this.w=this.upState.w,this.h=this.upState.h,this.states=new Array,this.upState!=null&&this.states.push(this.upState),this.downState!=null&&this.states.push(this.downState),this.overState!=null&&this.states.push(this.overState),this.mouseMoveCallback=this.handleMouseMove.bindAsEventListener(this),this.mouseUpCallback=this.handleMouseUp.bindAsEventListener(this)},render:function(e,t,n){this.currentState.render(e,this.x+t,this.y+n)},onAddedToScene:function(e){e(),this.states.each(function(e){e.root=this.root,e.parent=this,e.scene=this.scene,e.onAddedToScene()}.bind(this))},dispatchEvent:function(e,n){return this.isDown?n.type==t.MOUSE_UP&&(this.currentState=this.upState,this.isDown=!1,this.root.removeEventListener(t.MOUSE_MOVE,this.mouseMoveCallback),this.root.removeEventListener(t.MOUSE_UP,this.mouseUpCallback),this.sendClick.bind(this).defer(n)):n.type==t.MOUSE_DOWN&&(this.currentState=this.downState,this.isDown=!0,this.root.addEventListener(t.MOUSE_MOVE,this.mouseMoveCallback),this.root.addEventListener(t.MOUSE_UP,this.mouseUpCallback)),e(n)},handleMouseMove:function(e){var t=this.getSceneX(),n=this.getSceneY();e.x>=t&&e.x<=t+this.w&&e.y>=n&&e.y<=n+this.h?(this.currentState=this.downState,this.isOver=!0):(this.currentState=this.upState,this.isOver=!1)},handleMouseUp:function(e){this.currentState=this.upState,this.isDown=!1,this.root.removeEventListener(t.MOUSE_MOVE,this.mouseMoveCallback),this.root.removeEventListener(t.MOUSE_UP,this.mouseUpCallback)},sendClick:function(e){console.log("sendClick"),e.preventDefault();var n=e.x,r=e.y,i=t.CLICK,s=new t(i,!1,!1,n,r,this);this.dispatchEvent(s)}});return n}),n("minibot/display/scene/Container",["./SceneDisplayObject"],function(e){var t=Class.create(e,{layers:null,touchChildren:!0,resizable:!0,initialize:function(e){e(),this.layers=new Array},addChild:function(e,t,n){t==undefined&&(t=0);while(this.layers.length<=t)this.layers.push(new Array);n==undefined&&(n=this.layers[t].length),this.layers[t].splice(n,0,e),this.root!=null&&(e.root=this.root,e.scene=this.scene,e.parent=this,e.onAddedToScene()),this.resizable&&(this.w<e.x+e.w&&(this.w=e.x+e.w),this.h<e.y+e.h&&(this.h=e.y+e.h))},removeChild:function(e){for(var t=0;t<this.layers.length;t++){var n=this.layers[t];for(var r=0;r<n.length;r++)if(e===n[r]){n.splice(r,1),e.onRemovedFromScene();return}}},removeAll:function(){var e=this.layers,t;for(var n=0;n<e.length;n++){var r=e[n];for(var i=0;i<r.length;i++)t=r[i],t.onRemovedFromScene()}this.layers=new Array},render:function(e,t,n){t==undefined&&(t=0),n==undefined&&(n=0);var r,i,s,o,u,a;for(r=0;r<this.layers.length;r++){s=this.layers[r];for(i=0;i<s.length;i++){o=s[i];if(!o.isVisible)continue;u=this.x+t+o.x,a=this.y+n+o.y;if(u>=this.root.w||u<-1*o.w||a>=this.root.h||a<-1*o.h)continue;o.render(e,this.x+t,this.y+n)}}},setChildIndex:function(e,t){for(var n=0;n<this.layers.length;n++){var r=this.layers[n];for(var i=0;i<r.length;i++)if(e===r[i]){if(t>=r.length)return;r.splice(i,1),r.splice(t,0,e);return}}},dispatchEvent:function(e,t){var n=!1,r=!1,i,s,o,u;if("x"in t&&"y"in t){t.x-=this.x,t.y-=this.y;for(i=this.layers.length-1;i>=0;i--){o=this.layers[i];for(s=o.length-1;s>=0;s--){u=o[s];if(!u.isVisible)continue;t.x>=u.x&&t.x<=u.x+u.w&&t.y>=u.y&&t.y<=u.y+u.h&&(r=u.dispatchEvent(t),n=!0);if(n)break}if(n)break}}return r?!0:("x"in t&&"y"in t&&(t.x+=this.x,t.y+=this.y),e(t))},onAddedToScene:function(e){e();var t,n,r,i;for(t=0;t<this.layers.length;t++){r=this.layers[t];for(n=0;n<r.length;n++)i=r[n],i.root=this.root,i.scene=this.scene,i.parent=this,i.onAddedToScene()}},onRemovedFromScene:function(e){e();for(var t=0;t<this.layers.length;t++){var n=this.layers[t];for(var r=0;r<n.length;r++)n[r].onRemovedFromScene();this.layers[t]=null}this.layers=new Array}});return t}),n("minibot/display/scene/Sprite",["minibot/display/scene/SceneDisplayObject"],function(e){var t=Class.create(e,{sprite:null,composite:null,initialize:function(e,t){e(),this.sprite=t,this.w=t.w,this.h=t.h},render:function(e,t,n){try{this.scene.drawImage(this.sprite.img,this.sprite.x,this.sprite.y,this.sprite.w,this.sprite.h,this.x+t,this.y+n,this.w,this.h)}catch(r){console.log("SpriteObject: Fatal Error")}}});return t}),n("minibot/event/HtmlEvent",["minibot/utils","minibot/event/BaseEvent"],function(e,t){return e.define({name:"minibot.event.HtmlEvent",parent:t},{initialize:function(e,t,n){e(t,n)}},{CLICK:"HtmlEvent_Click",MOUSE_UP:"HtmlEvent_MouseUp",MOUSE_DOWN:"HtmlEvent_MouseDown",MOUSE_MOVE:"HtmlEvent_MouseMove",KEY_DOWN:"HtmlEvent_KeyDown",KEY_UP:"HtmlEvent_KeyUp",FOCUS:"HtmlEvent_Focus",BLUR:"HtmlEvent_Blur",DRAG_ENTER:"HtmlEvent_DragEnter",DRAG_EXIT:"HtmlEvent_DragExit",DRAG_OVER:"HtmlEvent_DragOver",DROP:"HtmlEvent_Drop"})}),n("minibot/display/html/HtmlElement",["minibot/display/DisplayObject","minibot/event/HtmlEvent"],function(e,t){var n=Class.create(e,{element:null,children:null,isInDOM:!1,htmlListeners:null,initialize:function(e){e(),arguments[1]!=undefined?typeof arguments[1]=="string"?this.element=new Element(arguments[1]):this.element=arguments[1]:this.element=new Element("div"),this.element==undefined,this.htmlListeners={},this.children=new Array,this.writeAttribute=this.element.writeAttribute.bind(this.element),this.readAttribute=this.element.readAttribute.bind(this.element),this.hide=this.element.hide.bind(this.element),this.show=this.element.show.bind(this.element)},addChild:function(e){this.element.insert(e.element),this.children.push(e),this.isInDOM&&e.onAddedToDOM()},removeChild:function(e){var t;for(var n=0;n<this.children.length;n++)t=this.children[n],e===t&&(this.children.splice(n,1),e.element.remove(),e.onRemovedFromDOM())},onAddedToDOM:function(e){this.isInDOM=!0;var t;for(var n=0;n<this.children.length;n++)t=this.children[n],t.onAddedToDOM()},isHtmlObject:function(){return!0},addToDOM:function(e){e.insert(this.element),this.onAddedToDOM()},onRemovedFromDOM:function(){},addEventListener:function(e,n,r){if(this.htmlListeners[n]==undefined){var i=null;switch(n){case t.CLICK:i="click";break;case t.FOCUS:i="focus";break;case t.BLUR:i="blur";break;case t.MOUSE_DOWN:i="mousedown";break;case t.MOUSE_MOVE:i="mousemove";break;case t.MOUSE_UP:i="mouseup";break;case t.KEY_DOWN:i="keydown";break;case t.KEY_UP:i="keyup";break;case t.DRAG_ENTER:i="dragenter";break;case t.DRAG_EXIT:i="dragexit";break;case t.DRAG_OVER:i="dragover";break;case t.DROP:i="drop";break;default:}i!=null&&(this.htmlListeners[n]=this.handleHtmlEvent.bindAsEventListener(this,n),this.element.observe(i,this.htmlListeners[n]))}e(n,r)},handleHtmlEvent:function(e,n){this.dispatchEvent(new t(n,e))}});return n}),n("minibot/display/scene/Scene",["minibot/event/EventDispatcher","./Container"],function(e,t){var n=Class.create(e,{container:null,width:null,height:null,initialize:function(e){e(),this.container=new t,this.container.resizable=!1,this.container.setRoot(this.container),this.container.setScene(this)},setWidth:function(e){this.width=e,this.container.setWidth(e)},getWidth:function(){return this.width},setHeight:function(e){this.height=e,this.container.setHeight(e)},getHeight:function(){return this.height},drawImage:function(e,t,n,r,i,s,o){},drawLine:function(e,t,n,r){},fillRect:function(e,t,n,r){},addChild:function(e,t){if(t==undefined||t==null)t=0;this.container.addChild(e,t)},removeChild:function(e){this.container.removeChild(e)},removeAllChildren:function(){this.container.removeAll()},render:function(e){this.container.render(e)}});return n}),n("minibot/display/html/CanvasScene",["minibot/display/scene/Scene","minibot/event/MouseEvent"],function(e,t){var n=Class.create(e,{element:null,context:null,initialize:function(e,t){e(),this.element=t==undefined?new Element("canvas"):t,this.context=this.element.getContext("2d"),this.element.observe("mousedown",this.handleMouseEvent.bind(this)),this.element.observe("mouseup",this.handleMouseEvent.bind(this)),this.element.observe("mousemove",this.handleMouseEvent.bind(this))},setWidth:function(e,t){e(t),this.element.width=t},setHeight:function(e,t){e(t),this.element.height=t},getElement:function(){return this.element},drawImage:function(e,t,n,r,i,s,o,u,a){this.context.drawImage(e,t,n,r,i,s,o,u,a)},handleMouseEvent:function(e){e.preventDefault();var n=e.currentTarget.offsetLeft*-1+e.currentTarget.offsetParent.offsetLeft*-1,r=e.currentTarget.offsetTop*-1+e.currentTarget.offsetParent.offsetTop*-1,i;n+=e.clientX,r+=e.clientY;switch(e.type){case"mousedown":i=t.MOUSE_DOWN;break;case"mousemove":i=t.MOUSE_MOVE;break;case"mouseup":i=t.MOUSE_UP;break;default:return}var s=new t(i,!1,!1,n,r,this.container);this.container.dispatchEvent(s)}});return n}),n("minibot/geom/Vector2",[],function(){var e=Class.create({x:0,y:0,initialize:function(e,t){this.x=e||0,this.y=t||0},reset:function(e,t){return this.x=e,this.y=t,this},toString:function(e){e=e||3;var t=Math.pow(10,e);return"["+Math.round(this.x*t)/t+", "+Math.round(this.y*t)/t+"]"},clone:function(){return new e(this.x,this.y)},copyTo:function(e){e.x=this.x,e.y=this.y},copyFrom:function(e){this.x=e.x,this.y=e.y},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},magnitudeSquared:function(){return this.x*this.x+this.y*this.y},normalise:function(){var e=this.magnitude();return e==0?this:(this.x=this.x/e,this.y=this.y/e,this)},reverse:function(){return this.x=-this.x,this.y=-this.y,this},plusEq:function(e){return this.x+=e.x,this.y+=e.y,this},plusNew:function(t){return new e(this.x+t.x,this.y+t.y)},minusEq:function(e){return this.x-=e.x,this.y-=e.y,this},minusNew:function(t){return new e(this.x-t.x,this.y-t.y)},multiplyEq:function(e){return this.x*=e,this.y*=e,this},multiplyNew:function(e){var t=this.clone();return t.multiplyEq(e)},divideEq:function(e){return this.x/=e,this.y/=e,this},divideNew:function(e){var t=this.clone();return t.divideEq(e)},dot:function(e){return this.x*e.x+this.y*e.y},angle:function(t){return Math.atan2(this.y,this.x)*(t?1:e.TO_DEGREES)},rotate:function(t,n){var r=Math.cos(t*(n?1:e.TO_RADIANS)),i=Math.sin(t*(n?1:e.TO_RADIANS));return e.temp.copyFrom(this),this.x=e.temp.x*r-e.temp.y*i,this.y=e.temp.x*i+e.temp.y*r,this},equals:function(e){return this.x==e.x&&this.y==e.x},isCloseTo:function(t,n){return this.equals(t)?!0:(e.temp.copyFrom(this),e.temp.minusEq(t),e.temp.magnitudeSquared()<n*n)},rotateAroundPoint:function(t,n,r){e.temp.copyFrom(this),e.temp.minusEq(t),e.temp.rotate(n,r),e.temp.plusEq(t),this.copyFrom(e.temp)},isMagLessThan:function(e){return this.magnitudeSquared()<e*e},isMagGreaterThan:function(e){return this.magnitudeSquared()>e*e}});return e.TO_DEGREES=180/Math.PI,e.TO_RADIANS=Math.PI/180,e.temp=new e,e}),n("minibot/resource/Resource",[],function(){var e=Class.create({initialize:function(e){this.id=e},id:null,loaded:!1,load:function(e,t){this.loaded=!0,t.defer()},isLoaded:function(){return this.loaded}});return e}),n("minibot/resource/ResourceManager",["minibot/utils","minibot/core/Manager"],function(e,t){var n=Class.create(t,{typeOrder:null,typeCount:null,typeMap:null,resourceMap:null,resourceCount:0,loadedCount:0,typeIndex:null,typeLoadedCount:0,initialize:function(e,t){e(t),this.typeOrder=[],this.typeCount=[],this.typeMap={},this.resourceMap={}},addType:function(e,t){this.typeOrder.push(e),this.typeCount.push(0),this.typeMap[e]=t,this.resourceMap[e]={}},addResource:function(e,t,n){if(this.typeMap[e]==undefined)return;var r=this.typeMap[e],i=new r(t,n);this.resourceMap[e][t]=i,this.resourceCount+=1;for(var s=0;s<this.typeOrder.length;s++)if(e==this.typeOrder[s]){this.typeCount[s]+=1;break}},loadAll:function(e,t){this.progressCallback=e,this.completeCallback=t,this.typeIndex=null,this.loadNextType()},loadNextType:function(){this.typeIndex==null?this.typeIndex=0:this.typeIndex+=1;if(this.typeIndex>=this.typeOrder.length){this.completeCallback.bind(this).defer();return}this.typeLoadedCount=0;var e=this.typeOrder[this.typeIndex],t,n;t=this.resourceMap[e];for(n in t)this.loadResource(e,n)},loadResource:function(e,t){var n=this.resourceMap[e][t];n.isLoaded()?this.handleResourceLoaded():n.load(this,this.handleResourceLoaded.bind(this))},handleResourceLoaded:function(){this.typeLoadedCount+=1;var e=Number(1/this.resourceCount);this.progressCallback(e),this.typeLoadedCount>=this.typeCount[this.typeIndex]&&this.loadNextType.bind(this).defer()},getResource:function(e,t){return this.resourceMap[e]==undefined?null:this.resourceMap[e][t]==undefined?null:this.resourceMap[e][t]}});return Object.extend(n,{getInstance:function(e){t.hasCore(e)||new n(e);var r=t.getInstance(e);return r}}),n}),n("minibot/resource/ImageResource",["minibot/resource/Resource"],function(e){var t=Class.create(e,{src:null,img:null,initialize:function(e,t,n){e(t),n.src!=undefined&&(this.src=n.src)},load:function(e,t){this.loaded=!0,this.src!=null?(this.img=new Image,this.img.addEventListener("load",this.handleLoadImageSuccess.bindAsEventListener(this,t),!1),this.img.addEventListener("error",this.handleLoadImageFailure.bindAsEventListener(this,t),!1),this.img.src=this.src):t()},handleLoadImageSuccess:function(e,t){t()},handleLoadImageFailure:function(e,t){console.log("ImageResource: Failed to load image."),t()}});return t.TYPE=1,t}),n("minibot/resource/SpriteResource",["minibot/resource/Resource","minibot/resource/ImageResource"],function(e,t){var n=Class.create(e,{imageId:null,imageResource:null,img:null,x:0,y:0,w:-1,h:-1,initialize:function(e,t,n){e(t),n!=undefined&&(n.image_id!=undefined?this.imageId=n.image_id:n.imageId!=undefined&&(this.imageId=n.imageId),n.x!=undefined&&(this.x=n.x),n.y!=undefined&&(this.y=n.y),n.w!=undefined&&(this.w=n.w),n.h!=undefined&&(this.h=n.h))},load:function(e,n){try{this.imageResource=e.getResource(t.TYPE,this.imageId),this.img=this.imageResource.img,this.w==-1&&(this.w=this.img.width),this.h==-1&&(this.h=this.img.height),this.loaded=!0}catch(r){console.log("ERROR")}n()}});return n.TYPE=2,n}),n("minibot/resource/AnimationResource",["minibot/resource/Resource","minibot/resource/SpriteResource"],function(e,t){var n=Class.create(e,{numberOfFrames:0,sprites:null,spriteIds:null,delays:null,initialize:function(e,t,n){e(t),this.spriteIds=[],this.delays=[];if(n.frames!=undefined)for(var r=0;r<n.frames.length;r++)this.spriteIds.push(n.frames[r].sprite_id),this.delays.push(n.frames[r].delay);this.numberOfFrames=this.spriteIds.length,this.sprites=[]},load:function(e,n){for(var r=0;r<this.spriteIds.length;r++){var i=e.getResource(t.TYPE,this.spriteIds[r]);this.sprites.push(i)}this.loaded=!0,n()},addFrame:function(e,t){this.sprites.push_back(e),this.delays.push_back(t),this.numberOfFrames++},getSprite:function(e){return this.sprites[e]},getDelay:function(e){return this.delays[e]},nextFrame:function(e){return(e+1)%this.numberOfFrames},atEnd:function(e){return e+1==this.numberOfFrames}});return n.TYPE=3,n}),n("minibot",["require","minibot/utils","minibot/system","minibot/core/Manager","minibot/display/DisplayObject","minibot/display/scene/SceneDisplayObject","minibot/display/scene/Animation","minibot/display/scene/Button","minibot/display/scene/Container","minibot/display/scene/Sprite","minibot/display/html/HtmlElement","minibot/display/html/CanvasScene","minibot/event/EventDispatcher","minibot/event/BaseEvent","minibot/event/MouseEvent","minibot/geom/Vector2","minibot/resource/Resource","minibot/resource/ResourceManager","minibot/resource/AnimationResource","minibot/resource/ImageResource","minibot/resource/SpriteResource"],function(e){var t={},n,r,i,s,o;return t.utils=e("minibot/utils"),t.system=e("minibot/system"),n={},n.Manager=e("minibot/core/Manager"),r={},r.DisplayObject=e("minibot/display/DisplayObject"),r.scene={},r.scene.SceneDisplayObject=e("minibot/display/scene/SceneDisplayObject"),r.scene.Animation=e("minibot/display/scene/Animation"),r.scene.Button=e("minibot/display/scene/Button"),r.scene.Container=e("minibot/display/scene/Container"),r.scene.Sprite=e("minibot/display/scene/Sprite"),r.html={},r.html.HtmlElement=e("minibot/display/html/HtmlElement"),r.html.CanvasScene=e("minibot/display/html/CanvasScene"),i={},i.EventDispatcher=e("minibot/event/EventDispatcher"),i.BaseEvent=e("minibot/event/BaseEvent"),i.MouseEvent=e("minibot/event/MouseEvent"),s={},s.Vector2=e("minibot/geom/Vector2"),o={},o.Resource=e("minibot/resource/Resource"),o.ResourceManager=e("minibot/resource/ResourceManager"),o.AnimationResource=e("minibot/resource/AnimationResource"),o.ImageResource=e("minibot/resource/ImageResource"),o.SpriteResource=e("minibot/resource/SpriteResource"),t.core=n,t.display=r,t.event=i,t.geom=s,t.resource=o,t}),t("minibot")})